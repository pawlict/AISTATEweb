<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="color-scheme" content="light">
  <title>{{ title }} — {{ app_name }}</title>
  <link rel="stylesheet" href="/static/app.css"/>
</head>
<body>
<div class="container">
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-top">
        <div class="logo logo-lg">
          <img src="/static/logo.png" alt="AISTATEweb logo"/>
        </div>
        <div class="brand-text">
          <div class="brand-name">{{ app_name }}</div>
          <div class="brand-ver">{{ app_version }}</div>
        </div>
      </div>

      <nav class="nav">
        <a href="/new-project" class="{{ 'active' if active=='new_project' else '' }}" data-i18n="nav.new_project">New project</a>
        <a href="/transcription" class="{{ 'active' if active=='transcription' else '' }}" data-i18n="nav.transcription">Transcription</a>
        <a href="/diarization" class="{{ 'active' if active=='diarization' else '' }}" data-i18n="nav.diarization">Diarization</a>
        <a href="/settings" class="{{ 'active' if active=='settings' else '' }}" data-i18n="nav.settings">Settings</a>
        <a href="/logs" class="{{ 'active' if active=='logs' else '' }}" data-i18n="nav.logs">Logs</a>
        <a href="/info" class="{{ 'active' if active=='info' else '' }}" data-i18n="nav.info">Info</a>
        <a href="/save" class="{{ 'active' if active=='save' else '' }}" data-i18n="nav.save">Save</a>
      </nav>
    </div>
  </aside>

  <main class="main">
    <div class="topbar">
      <div class="topbar-left">
        <div class="small"><span data-i18n="top.current_project">Bieżący projekt</span>: <b id="current_project">(…)</b></div>
        <div class="small"><span data-i18n="top.source_file">Plik źródłowy projektu</span>: <b id="current_audio">(…)</b></div>
      </div>

      <div class="topbar-right">
        <select id="project_select" class="select"></select>
        <button class="btn secondary" id="refresh_projects_btn" type="button" data-i18n="btn.refresh">Odśwież</button>
      </div>
    </div>

    {% block content %}{% endblock %}
  </main>
</div>

<script src="/static/app.js"></script>
<script>
  document.getElementById("refresh_projects_btn").addEventListener("click", async ()=>{
    await refreshProjects("project_select");
  });

  document.getElementById("project_select").addEventListener("change", async (e)=>{
    const v = e.target.value || "";
    if(v){
      AISTATE.projectId = v;
      await refreshCurrentProjectInfo();
    }
  });

  (async()=>{
    await refreshProjects("project_select");
    await refreshCurrentProjectInfo();
    applyI18n();
  })();
</script>
{% block scripts %}{% endblock %}
</body>
</html>
